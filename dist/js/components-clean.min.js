class ComponentLoader{constructor(){this.currentPage = this.getCurrentPage();this.init();}getCurrentPage(){const path = window.location.pathname;const filename = path.split('/').pop().toLowerCase();const pageMap ={'1 homepage.html': 'home', '2 issues.html': 'issues', '3 about.html': 'about', '4 programs.html': 'programs', '5 action center.html': 'action', '6 partners.html': 'partners', '7 news.html': 'news', '8 contact.html': 'contact', '9 donate.html': 'donate'};return pageMap[filename] || 'home';}async loadComponent(elementId, componentPath){try{const response = await fetch(componentPath);if (!response.ok) throw new Error(`Failed to load ${componentPath}`);const html = await response.text();const element = document.getElementById(elementId);if (element){element.innerHTML = html;return true;}}catch (error){console.warn(`Could not load component ${componentPath}:`, error);return false;}}setActiveNavItem(){const navLinks = document.querySelectorAll('.header-nav a');navLinks.forEach(link =>{const href = link.getAttribute('href');if (href && href.includes(this.currentPage)){link.classList.add('active');}});}initMobileMenu(){const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');const headerNav = document.querySelector('.header-nav');if (mobileMenuToggle && headerNav){mobileMenuToggle.addEventListener('click', () =>{const isActive = headerNav.classList.contains('active');headerNav.classList.toggle('active');mobileMenuToggle.setAttribute('aria-expanded', !isActive);if (!isActive){headerNav.style.display = 'flex';headerNav.style.position = 'absolute';headerNav.style.top = '100%';headerNav.style.left = '0';headerNav.style.right = '0';headerNav.style.background = 'var(--white)';headerNav.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.1)';headerNav.style.padding = '20px';headerNav.style.flexDirection = 'column';headerNav.style.gap = '10px';headerNav.style.zIndex = '1002';}else{headerNav.style.display = '';headerNav.style.position = '';headerNav.style.top = '';headerNav.style.left = '';headerNav.style.right = '';headerNav.style.background = '';headerNav.style.boxShadow = '';headerNav.style.padding = '';headerNav.style.flexDirection = '';headerNav.style.gap = '';headerNav.style.zIndex = '';}});document.addEventListener('click', (e) =>{if (!e.target.closest('.header-nav') && !e.target.closest('.mobile-menu-toggle')){if (headerNav.classList.contains('active')){headerNav.classList.remove('active');mobileMenuToggle.setAttribute('aria-expanded', 'false');headerNav.style.display = '';headerNav.style.position = '';headerNav.style.top = '';headerNav.style.left = '';headerNav.style.right = '';headerNav.style.background = '';headerNav.style.boxShadow = '';headerNav.style.padding = '';headerNav.style.flexDirection = '';headerNav.style.gap = '';headerNav.style.zIndex = '';}}});}}initHeaderScrollEffect(){window.addEventListener('scroll', () =>{const header = document.querySelector('.header');if (header){if (window.scrollY > 100){header.style.background = 'rgba(255, 255, 255, 0.95)';header.style.backdropFilter = 'blur(10px)';header.style.webkitBackdropFilter = 'blur(10px)';}else{header.style.background = 'var(--white)';header.style.backdropFilter = 'none';header.style.webkitBackdropFilter = 'none';}}});}initSmoothScrolling(){document.querySelectorAll('a[href^="#"]').forEach(anchor =>{anchor.addEventListener('click', function (e){e.preventDefault();const target = document.querySelector(this.getAttribute('href'));if (target){target.scrollIntoView({behavior: 'smooth', block: 'start'});}});});}async init(){const headerLoaded = await this.loadComponent('global-header', 'includes/header.html');const footerLoaded = await this.loadComponent('global-footer', 'includes/footer.html');setTimeout(() =>{if (headerLoaded){this.setActiveNavItem();this.initMobileMenu();this.initHeaderScrollEffect();}this.initSmoothScrolling();this.initOtherComponents();}, 100);}initOtherComponents(){this.initDropdowns();this.initForms();this.initScrollAnimations();}initDropdowns(){const dropdowns = document.querySelectorAll('.dropdown');dropdowns.forEach(dropdown =>{const toggle = dropdown.querySelector('.dropdown-toggle');const menu = dropdown.querySelector('.dropdown-menu');if (toggle && menu){document.addEventListener('click', (e) =>{if (!dropdown.contains(e.target)){menu.style.opacity = '0';menu.style.visibility = 'hidden';}});}});}initForms(){const newsletterForm = document.querySelector('.newsletter-form');if (newsletterForm){newsletterForm.addEventListener('submit', (e) =>{e.preventDefault();const email = newsletterForm.querySelector('input[type="email"]').value;if (email){console.log('Newsletter signup:', email);}});}}initScrollAnimations(){const observerOptions ={threshold: 0.1, rootMargin: '0px 0px -50px 0px'};const observer = new IntersectionObserver((entries) =>{entries.forEach(entry =>{if (entry.isIntersecting){entry.target.classList.add('fade-in');observer.unobserve(entry.target);}});}, observerOptions);const animateElements = document.querySelectorAll('.change-card, .team-member, .impact-item, .challenge-item');animateElements.forEach(el => observer.observe(el));}}document.addEventListener('DOMContentLoaded', () =>{new ComponentLoader();});window.PraxisUtils ={showButtonLoading: (button, originalText = null) =>{if (!originalText) originalText = button.textContent;button.dataset.originalText = originalText;button.textContent = 'Loading...';button.style.opacity = '0.7';button.disabled = true;}, hideButtonLoading: (button) =>{const originalText = button.dataset.originalText || 'Click Here';button.textContent = originalText;button.style.opacity = '1';button.disabled = false;}, scrollToElement: (elementId) =>{const element = document.getElementById(elementId);if (element){element.scrollIntoView({behavior: 'smooth', block: 'start'});}}, formatNumber: (num) =>{return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');}, debounce: (func, wait) =>{let timeout;return function executedFunction(...args){const later = () =>{clearTimeout(timeout);func(...args);};clearTimeout(timeout);timeout = setTimeout(later, wait);};}};document.addEventListener('DOMContentLoaded', () =>{document.querySelectorAll('a[href^="http"]').forEach(link =>{if (link.hostname !== window.location.hostname){link.setAttribute('target', '_blank');link.setAttribute('rel', 'noopener noreferrer');}});document.querySelectorAll('a[href^="tel:"]').forEach(link =>{link.addEventListener('click', (e) =>{console.log('Phone number clicked:', link.href);});});document.querySelectorAll('a[href^="mailto:"]').forEach(link =>{link.addEventListener('click', (e) =>{console.log('Email link clicked:', link.href);});});});